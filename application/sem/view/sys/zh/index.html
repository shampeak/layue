{php}
        $media = getConfig('MEDIA_TYPE');
        {/php}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>layuiAdmin 网站用户</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="../../../layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="../../../layuiadmin/style/admin.css" media="all">
    <!--<link rel="stylesheet" href="../../../layuiadmin/style/global.css" media="all">-->
    <link rel="stylesheet" href="/static/Sham.css" media="all">
</head>
<body>

<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-card-body">
            <div class="layui-form">
                <div class="layui-inline layui-form-item-sm text-sm">
                    <label class="layui-form-label">连接</label>
                    <div class="layui-input-inline" style="width:300px">
                        <select name="connect">
                            <option value="9">全部</option>
                            <option value="1">连接正常</option>
                            <option value="0">连接断开</option>
                        </select>
                    </div>
                </div>

                <div class="layui-inline layui-form-item-sm text-sm">
                    <label class="layui-form-label">是否有效</label>
                    <div class="layui-input-inline" style="width:300px">
                        <select name="enable">
                            <option value="9">全部</option>
                            <option value="1">有效</option>
                            <option value="0">无效</option>
                        </select>
                    </div>
                </div>

                <div class="layui-inline layui-form-item-sm text-sm">
                    <label class="layui-form-label">类型</label>
                    <div class="layui-input-inline" style="width:300px">
                        <select name="type">
                            <option value="99">全部</option>
                            <option value="0">自用</option>
                            <option value="1">放户</option>
                        </select>
                    </div>
                </div>

                <div class="layui-inline layui-form-item-sm text-sm">
                    <label class="layui-form-label">媒体</label>
                    <div class="layui-input-inline" style="width:300px">
                        <select name="mediatype">
                            <option value="0">全部</option>
                            {foreach $media as $key=>$value}
                            <option value="{$key}">{$value}</option>
                            {/foreach}
                        </select>
                    </div>
                </div>


                <div class="layui-inline text-sm">
                    <label class="layui-form-label">关键词</label>
                    <div class="layui-input-block">
                        <input name="key" type="text" class="layui-input layui-input-sm" id="test6" placeholder="关键词">
                    </div>

                </div>

                <div class="layui-inline">
                    <label class="layui-form-label"></label>
                    <button class="layui-btn layui-btn-sm layuiadmin-btn-admin" lay-submit lay-filter="LAY-front-search">
                        <i class="layui-icon layui-icon-search layuiadmin-button-btn"></i> 提交
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="layui-card">
        <div class="layui-card-body">

            <div style="padding-bottom: 10px;">
                <button class="layui-btn layuiadmin-btn-admin" data-type="add">添加</button>
            </div>

            <table id="LAY-content-list" lay-filter="LAY-content-list"></table>

            <!-- 头像 -->
            <script type="text/html" id="imgTpl">
                <img style="display: inline-block; width: 50%; height: 100%;" src= {{ d.avatar }}>
            </script>

            <script type="text/html" id="usexTpl">
                {{#  if(d.sex == 1){ }}
                男
                {{#  } else { }}
                女
                {{#  } }}
            </script>

            <!-- 状态 -->
            <script type="text/html" id="connectcheck">
                {{#  if(d.connectcheck && d.enable){ }}
                <button class="layui-btn layui-btn-xs">正常</button>
                {{#  } else { }}
                <button class="layui-btn layui-btn-primary layui-btn-xs">断开</button>
                {{#  } }}
            </script>

            <!-- 状态 -->
            <script type="text/html" id="buttonTpl">
                {{#  if(d.enable){ }}
                <button class="layui-btn layui-btn-xs" lay-event="enable">有效</button>
                <!--<input type="checkbox" class="layui-input-sm" checked lay-skin="switch" lay-filter="status" lay-text="有效|无效">-->
                {{#  } else { }}
                <button class="layui-btn layui-btn-primary layui-btn-xs" lay-event="enable">无效</button>
                <!--<input type="checkbox" class="layui-input-sm" lay-skin="switch" lay-filter="status" lay-text="有效|无效">-->
                {{#  } }}
            </script>

            <!-- 操作 -->
            <script type="text/html" id="table-admin-manage">
                <a class="layui-btn layui-btn-normal layui-btn-xs" lay-event="api"><i class="layui-icon layui-icon-vercode"></i>接口</a>
                <a class="layui-btn layui-btn-warning layui-btn-xs" lay-event="fd"><i class="layui-icon layui-icon-vercode"></i>返点</a>
                <a class="layui-btn layui-btn-normal layui-btn-xs" lay-event="edit"><i class="layui-icon layui-icon-edit"></i>编辑</a>
                <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del"><i class="layui-icon layui-icon-delete"></i>删除</a>
            </script>
        </div>
    </div>



</div>

<script src="../../../layuiadmin/layui/layui.js"></script>
<script>
    layui.config({
        base: '../../../layuiadmin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'laydate','table', 'semzh','code'], function(){
        var $ = layui.$
                ,form = layui.form
                ,admin = layui.admin
                ,table = layui.table;
        var laydate = layui.laydate;


//        //日期范围
//        laydate.render({
//            elem: '#test6'
//            ,range: true
//        });

//        form.on('switch(status)',function(data){
////            var field = data.field;
////            $.ajax({
////                url: '/api/sem.zh/enable'
////                ,type:'POST'
////                ,data: data
////                ,success: function(res){
////                    if(res.code==0){
//////                        table.reload('LAY-content-list');
//////                        //table.reload('LAY-content-list');
//////                        layer.close(index);
////                    }else{
////                        layer.msg(res.msg);
////                    }
////                }
////            });
//
//            layer.msg('监听状态操作');
//            console.dir(data);
//
//            //$.ajax({});
//
//        })

        //监听搜索
        form.on('submit(LAY-front-search)', function(data){
            var field = data.field;

            //执行重载
            table.reload('LAY-content-list', {
                where: field
            });
        });

        //事件
        var active = {
            add: function(){
                layer.open({
                    type: 2
                    ,title: '添加'
                    ,content: '/sem/sys.zh/addnew'
                    ,maxmin: true
                    ,area: ['500px', '600px']
                    ,btn: ['确定', '取消']
                    ,yes: function(index, layero){

                        var iframeWindow = window['layui-layer-iframe'+ index]
                                ,submitID = 'LAY-addnew-front-submit'
                                ,submit = layero.find('iframe').contents().find('#'+ submitID);

                        //监听提交
                        iframeWindow.layui.form.on('submit('+ submitID +')', function(data){
                            var field = data.field; //获取提交的字段

                            //提交 Ajax 成功后，静态更新表格中的数据
                            //$.ajax({});
                            $.ajax({
                                url: '/api/sem.zh/addnew'
                                ,type:'POST'
                                ,data: data.field
                                ,success: function(res){
                                    if(res.code==0){
                                        table.reload('LAY-content-list');
                                        //table.reload('LAY-content-list');
                                        layer.close(index);
                                    }
                                }
                            });
                        });

                        submit.trigger('click');
                    }
                });
            }
        };

        $('.layui-btn.layuiadmin-btn-admin').on('click', function(){
            var type = $(this).data('type');
            active[type] ? active[type].call(this) : '';
        });
    });
</script>
</body>
</html>
